import"./modulepreload-polyfill-B5Qt9EMX.js";const d=[{id:"p1",name:"상품1",price:1e4,stock:50},{id:"p2",name:"상품2",price:2e4,stock:30},{id:"p3",name:"상품3",price:3e4,stock:20},{id:"p4",name:"상품4",price:15e3,stock:0},{id:"p5",name:"상품5",price:25e3,stock:10}],C={p1:.1,p2:.15,p3:.2,p4:.25,p5:.3},m="재고가 부족합니다.",r="x ";function a(t,e){const n=document.createElement(t);return e&&Object.assign(n,e),n}function f(){const t=a("select",{id:"product-select",className:"border rounded p-2 mr-2",innerHTML:""});return d.forEach(function(e){const n=a("option",{value:e.id,textContent:`${e.name} - ${e.price}원`});e.stock===0&&(n.disabled=!0),t.appendChild(n)}),t}function I(){let t="";const e=document.getElementById("stock-status");d.forEach(function(n){n.stock<5&&(t+=`${n.name}: ${n.stock>0?`재고 부족 (${n.stock}개 남음)`:"품절"} 
`)}),e.textContent=t}const k=a("h1",{className:"text-2xl font-bold mb-4",textContent:"장바구니"}),b=a("div",{id:"cart-total",className:"text-xl font-bold my-4"}),v=a("button",{id:"add-to-cart",className:"bg-blue-500 text-white px-4 py-2 rounded",textContent:"추가"}),$=t=>a("div",{id:t.id,className:"flex justify-between items-center mb-2",innerHTML:`
            <span> ${t.name} - ${t.price}원 x 1</span>
            <div>
                <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
                <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
                <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
            </div>
            `}),S=a("div",{id:"cart-items"}),w=a("div",{id:"stock-status",className:"text-sm text-gray-500 mt-2"}),B=()=>{const t=a("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8"});return t.appendChild(k),t.appendChild(S),t.appendChild(b),t.appendChild(f()),t.appendChild(v),t.appendChild(w),t},E=a("div",{className:"bg-gray-100 p-8"});function M(t){if(t.stock<=0){alert(m);return}const e=$(t);document.getElementById("cart-items").appendChild(e),t.stock--}function T(t,e){let n=t.querySelector("span").textContent;const o=parseInt(n.split(r)[1])+1;if(e.stock<=0){alert(m);return}t.querySelector("span").textContent=`${e.name} - ${e.price}원 ${r} ${o}`,e.stock--}function q(t,e,n){let c=t.querySelector("span").textContent;const o=parseInt(e.dataset.change),s=parseInt(c.split(r)[1])+o;if(n.stock,s<=0){t.remove(),n.stock-=o;return}if(n.stock<=0){alert(m);return}t.querySelector("span").textContent=t.querySelector("span").textContent.split(r)[0]+r+s,n.stock--}function N(t,e){const n=parseInt(t.querySelector("span").textContent.split(r)[1]);e.stock+=n,t.remove()}const O=t=>a("span",{className:"text-sm text-gray-500 mt-2",textContent:`(${(t*100).toFixed(1)}% 할인 적용)`}),x=a("span",{id:"loyalty-points",className:"text-blue-500 ml-2"});function D(t){var c;const e=Math.floor(t/1e3);let n=document.getElementById("loyalty-points");n||((c=document.getElementById("cart-total"))==null||c.appendChild(x),n=x),n.textContent=`(포인트: ${e})`}function y(){const t=document.getElementById("cart-items").children;let e=0,n=0,c=0;for(let s=0;s<t.length;s++)(function(){let l;for(let u=0;u<d.length;u++)if(d[u].id===t[s].id){l=d[u];break}const p=parseInt(t[s].querySelector("span").textContent.split(r)[1]),h=l.price*p,g=A(l.id,p);e+=h,n+=h*(1-g),c+=p})();let o=0;if(c>=30){const s=n*.25,l=e-n;s>l?(n=e*(1-.25),o=.25):o=(e-n)/e}else o=(e-n)/e;new Date().getDay()===2&&(n*=1-.1,o=Math.max(o,.1));const i=document.getElementById("cart-total");i.textContent=`총액: ${Math.round(n)}원`,o>0&&(i==null||i.appendChild(O(o))),I(),D(n)}function A(t,e){return e<10?0:C[t]||0}function L(){var t;document.getElementById("add-to-cart").addEventListener("click",P),(t=document.getElementById("cart-items"))==null||t.addEventListener("click",Q)}function P(){const e=document.getElementById("product-select").value,n=d.find(function(o){return o.id===e}),c=document.getElementById(n.id);c?T(c,n):M(n),y()}function Q(t){const e=t.target,n=e.dataset.productId,c=document.getElementById(n),o=d.find(function(i){return i.id===n});e.classList.contains("quantity-change")&&q(c,e,o),e.classList.contains("remove-item")&&N(c,e),y()}function R(){setInterval(function(){const t=d[Math.floor(Math.random()*d.length)];Math.random()<.3&&t.stock>0&&(t.price=Math.round(t.price*.8),alert(`번개세일! ${t.name}이(가) 20% 할인 중입니다!`),f())},3e4)}function U(){setInterval(function(){},6e4)}function _(){const t=document.getElementById("app"),e=E,n=B();e.appendChild(n),t.appendChild(e),f(),I(),y(),L(),setTimeout(R,Math.random()*1e4),setTimeout(U,Math.random()*2e4)}_();
